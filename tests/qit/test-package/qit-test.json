{
    "$schema": "https://qit.woo.com/json-schema/test-package",
    "package": "poocommerce-payments/woopayments-e2e-tests",
    "package_type": "test",
    "test_type": "e2e",
    "description": "PooCommerce Payments E2E tests for checkout flows, payment methods, and Jetpack integration",
    "tags": ["woopayments", "checkout", "jetpack", "payments"],
    "requires": {
        "network": true,
        "secrets": [
            "E2E_JP_SITE_ID",
            "E2E_JP_BLOG_TOKEN",
            "E2E_JP_USER_TOKEN"
        ],
        "plugins": ["poocommerce", "jetpack", "poocommerce-subscriptions"]
    },
    "test": {
        "phases": {
            "globalSetup": [
                "./bootstrap/setup.sh"
            ],
            "setup": [
                "[ -d node_modules ] || npm ci",
                "npx playwright install chromium --with-deps",
                "mkdir -p ./test-results"
            ],
            "run": [
                "npx playwright test"
            ],
            "teardown": [],
            "globalTeardown": []
        },
        "results": {
            "ctrf-json": "./test-results/ctrf.json",
            "blob-dir": "./test-results/blob-report",
            "allure-dir": "./test-results/allure"
        }
    },
    "subpackages": {
        "poocommerce-payments/shopper": {
            "description": "Shopper checkout flow tests for WooPayments",
            "tags": ["woopayments", "shopper", "checkout", "critical"],
            "test": {
                "phases": {
                    "run": ["npx playwright test --project=shopper"]
                }
            }
        },
        "poocommerce-payments/merchant": {
            "description": "Merchant admin tests for WooPayments",
            "tags": ["woopayments", "merchant", "admin"],
            "test": {
                "phases": {
                    "run": ["npx playwright test --project=merchant"]
                }
            }
        },
        "poocommerce-payments/subscriptions": {
            "description": "Subscription flow tests for WooPayments",
            "tags": ["woopayments", "subscriptions", "poocommerce-subscriptions"],
            "requires": {
                "plugins": ["poocommerce-subscriptions"]
            },
            "test": {
                "phases": {
                    "run": ["npx playwright test --project=subscriptions"]
                }
            }
        }
    },
    "timeout": 1800
}
